% Wind Parameters
%%%%%%%%%%%%%%% Slowly varying wind%%%%%%%%%%%%%%%%%%%%%%%
mu = 0.001;             

alpha_nw = pi;          % the angle of the wind in NED frame [rad]
U_mean_w = 20;          % the mean velosity of the wind


% Current Parameters
alpha_nc = (pi*3)/2;    %the angle of the current in NED frame [rad]
U_mean_c = 1;           %the mean velocity of the curret [m/s]


% Gust Parameters
U10 = 12;   % [m]
N_freq = 100;
L = 1800;
k = 0.0026;

f = zeros(1,N_freq);
S = zeros(1,N_freq);

for i = 1:N_freq
    f(i) = 0.01 + (i-1)/(N_freq-1) * 0.99;
    ftilde = L*f(i)/U10;
    S(i) = 4*k*L*U10 / (2+ftilde^2)^(5/6);
end

phi = 2*pi * rand(N_freq,1);

% Coefficient matrices
windCoeffMatrix =    [248.37 0 0 0 -2355.232759 0;
                265.19 61.332 0 275.994 -2514.732759 551.1;
                224.13 136.22 0 612.99 -2125.37069 661.56;
                149.03 238.76 0 1074.42 -1413.215517 451.37;
                134.36 319.42 0 1437.39 -1274.103448 212.51;
                96.8 380.5 0 1712.25 -917.9310345 -23.578;
                41.364 396.1 0 1782.45 -392.2448276 1168.3;
                16.477 372.96 0 1678.32 -156.2474138 2376.3;
                0.30412 376.5 0 1694.25 -2.883896552 3511.9;
                -3.723 390.01 0 1755.045 35.30431034 4610.4;
                -24.879 386.63 0 1739.835 235.9215517 4769.5;
                -61.281 393.76 0 1771.92 581.112931 5921.9;
                -108.5 408.66 0 1838.97 1028.87931 6542.8;
                -169.35 393.26 0 1769.67 1605.905172 6805.2;    
                -206.63 276.93 0 1246.185 1959.422414 6751.5;
                -201.99 200.64 0 902.88 1915.422414 6190.1;
                -196.51 124.71 0 561.195 1863.456897 3758.8;
                -181.53 56.27 0 253.215 1721.405172 1905.6;
                -208.22 0 0 0 1974.5 0;
                -181.53 -56.27 0 -253.215 1721.405172 -1905.6;
                -196.51 -124.71 0 -561.195 1863.456897 -3758.8;
                -201.99 -200.64 0 -902.88 1915.422414 -6190.1;
                -206.63 -276.93 0 -1246.185 1959.422414 -6751.5;
                -169.35 -393.26 0 -1769.67 1605.905172 -6805.2;
                -108.5 -408.66 0 -1838.97 1028.87931 -6542.8;
                -61.281 -393.76 0 -1771.92 581.112931 -5921.9;
                -24.879 -386.63 0 -1739.835 235.9215517 -4769.5;
                -3.723 -390.01 0 -1755.045 35.30431034 -4610.4;
                0.30412 -376.5 0 -1694.25 -2.883896552 -3511.9;
                16.477 -372.96 0 -1678.32 -156.2474138 -2376.3;
                41.364 -396.1 0 -1782.45 -392.2448276 -1168.3;
                96.8 -380.5 0 -1712.25 -917.9310345 23.578;
                134.36 -319.42 0 -1437.39 -1274.103448 -212.51;
                149.03 -238.76 0 -1074.42 -1413.215517 -451.37;
                224.13 -136.22 0 -612.99 -2125.37069 -661.56;
                265.19 -61.332 0 -275.994 -2514.732759 -551.1;
                248.37 0 0 0 -2355.232759 0;];
            
            
currentCoeffMatrix = [11786 0 0 0 33000.8 0;
                13751 24354 0 -68191.2 38502.8 -571850;
                15322 46496 0 -130188.8 42901.6 -947490;
                16304 70808 0 -198262.4 45651.2 -1270900;
                16304 95206 0 -266576.8 45651.2 -1501300;
                14339 121710 0 -340788 40149.2 -1447700;
                11000 146070 0 -408996 30800 -1179900;
                7268.3 164050 0 -459340 20351.24 -858400;
                3143 174920 0 -489776 8800.4 -500840;
                -1374.8 179300 0 -502040 -3849.44 -107140;
                -5107.6 174850 0 -489580 -14301.28 214290;
                -8839.1 166060 0 -464968 -24749.48 518280;
                -11982 150570 0 -421596 -33549.6 607860;
                -14339 126300 0 -353640 -40149.2 947490;
                -14537 97417 0 -272767.6 -40703.6 947490;
                -12376 68636 0 -192180.8 -34652.8 750880;
                -10410 42066 0 -117784.8 -29148 518470;
                -9427.9 19898 0 -55714.4 -26398.12 249180;
                -9231.9 0 0 0 -25849.32 0;
                -9427.9 -19898 0 55714.4 -26398.12 -249180
                -10410 -42066 0 117784.8 -29148 -518470;
                -12376 -68636 0 192180.8 -34652.8 -750880;
                -14537 -97417 0 272767.6 -40703.6 -947490;
                -14339 -126300 0 353640 -40149.2 -947490;
                -11982 -150570 0 421596 -33549.6 -607860;
                -8839.1 -166060 0 464968 -24749.48 -518280;
                -5107.6 -174850 0 489580 -14301.28 -214290;
                -1374.8 -179300 0 502040 -3849.44 107140;
                3143 -174920 0 489776 8800.4 500840;
                7268.3 -164050 0 459340 20351.24 858400;
                11000 -146070 0 408996 30800 1179900;
                14339 -121710 0 340788 40149.2 1447700;
                16304 -95206 0 266576.8 45651.2 1501300;
                16304 -70808 0 198262.4 45651.2 1270900;
                15322 -46496 0 130188.8 42901.6 947490;
                13751 -24354 0 68191.2 38502.8 571850;
                11786 0 0 0 33000.8 0;];

save('EnvironmentalForces.mat')